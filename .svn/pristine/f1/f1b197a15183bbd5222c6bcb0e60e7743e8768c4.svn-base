class Exemplare < ActiveRecord::Base
  #Busca
  scope :with_nome_vulgar, lambda {|parameter| where('nome_vulgar like ?', "%#{parameter}%")}
  #scope :with_nome_vulgar, lambda {|parameter| where('filo_id like ?', "%#{parameter}%")}
  
  #Relacionamentos
  belongs_to :filo
  belongs_to :clase
  belongs_to :ordem
  belongs_to :familia
  belongs_to :genero
  belongs_to :espec
  has_many	 :imagems
  
  #Acesso
  attr_accessible :biografia, :clase_id, :codigo_identificacao, :data_chegada, :data_coleta, :filo_id, :espec_id, :familia_id, :genero_id, :identificador, :local_origem, :localizacao_exemplar, :localizacao_geografica, :nome_cientifico, :nome_vulgar, :ordem_id, :status, :imagems_attributes , :foto
  
  #Validação
  validates_presence_of :nome_vulgar, :message =>" - Deve ser preenchido"

  accepts_nested_attributes_for :imagems, :allow_destroy => true  
  
  def self.search(parameters)
	
	exemplar_query = self.scoped
	parameters.each do |parameter, value|
		
		if exemplar_query.respond_to? parameter
			exemplar_query = exemplar_query.send(parameter, value)
		end
	end
	exemplar_query
  end
  
end
